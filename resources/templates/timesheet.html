{% extends "base.html" %}
{% block content %}
<style>
form
{
  float:right;
}
</style>
<div style="text-align:right">
  <form method="POST" action="/timesheet_next">
    {% csrf-field %}
    <input type="text"
           style="display:none"
           name="enddate"
           value="{{enddate}}" />
    <input type="submit" class="btn btn-primary" name="forward" value="->" />
  </form>
  <form method="POST" action="/timesheet_back">
    {% csrf-field %}
    Period End Date:
    <input type="text"
           name="enddate"
           style="displayenddate"
           value="{{enddate}}" disabled/>
    <input type="text"
           style="display:none"
           name="enddate"
           value="{{enddate}}" />
    <input type="submit" class="btn btn-primary" name="backward" value="<-" />
  </form>
</div>

<div class="row">
  <div class="span12">
    <table class="timesheet fixed table table-bordered table-striped table-highlight">
      <thead>
        <tr style="background-color:#0d47a1;color:#ffffff">
          <th style="width: 180px;text-align: center;">Name</th>
          {% for day in days %}
          <th style="width: 80px;text-align: center;">{{day|safe}}</th>
          {% endfor %}
          <th style="width: 30px;text-align: center;">Total</th>
        </tr>
      </thead>
      <form method="POST" id="timesheet" action="/timesheet_submit" onsubmit="emptyValue()">
        <input type="text"
               style="display:none"
               name="enddate"
               value="{{enddate}}" />
        {% csrf-field %}
        <tbody>
          {% for row in rows %}
          <!--row{{row}}-->
          <tr>
            <td>
              <select name="charge-row{{row}}" form="timesheet">
                <option value=""></option>
                {% for charge in charges %}
                <option value="{{charge.id}}">{{charge.name}}</option>
                {% endfor %}
              </select>
            </td>
            {% for day in dates %}
            <td style="width: 30px;text-align: center; background-color:{% if forloop.counter|weekend? %}#606060{% else %}#FFFFFF{% endif %}; color: #ff0000 ;">
              <input onblur="findTotal('row{{row}}')" 
                     type="text" 
                     name="row{{row}}-{{forloop.counter}}" 
                     id="{{day}}" 
                     size="4"/> </td>
            {% endfor %}
            <td style="width: 30px;text-align: center;"><input type="text" id="row{{row}}" size="4"/> </td>
          </tr>
          <!--end of row{{row}}-->
          {% endfor %}
          <tr>
            <td colspan="2"><input type="text" name="Signature" value="" /></td>
            <td colspan="5"></td>
            <td colspan="2"><input type="submit" class="btn btn-primary" name="submit" value="Submit" /></td>
          </tr>
        </tbody>
      </form>
    </table>
  </div>

  <script type="text/javascript">

function findTotal(name){
  var tot=0;
  {% for day in days %}
  var arr = document.getElementsByName(name + '-' + {{forloop.counter}})[0];
    if(parseInt(arr.value))
      tot += parseInt(arr.value);
  {% endfor %}
  document.getElementById(name).value = tot;
}

function emptyValue(){
  {% for row in rows %}
  var arr = document.getElementsByName('row'+{{row}});
  for(var i=0;i<arr.length;i++){
    if(arr[i].value=="") {
      arr[i].value="---";
    }
  }
  {% endfor %}
}
  </script>

</div>
  {% endblock %}
